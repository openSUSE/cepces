[tox]
requires =
    tox>=4
env_list = lint, format, type, pycodestyle, 3.9, 3.10, 3.11, 3.12, 3.13, 3.14

[gh-actions]
python =
    3.9: py39
    3.10: py310, mypy
    3.11: py311, mypy
    3.12: py312, mypy
    3.13: py313, mypy
    3.14: py314, mypy

[testenv]
description = run unit tests
deps = pytest
commands = pytest {posargs:tests}

[testenv:lint]
description = run linter
changedir = {tox_root}
skip_install = true
deps =
    ruff
commands = {envpython} -m ruff {posargs:check {tox_root}}

[testenv:format]
description = run formatter
changedir = {tox_root}
skipsdist = true
skip_install = true
deps = black
commands =
    {envpython} -m black --check --diff {posargs:{tox_root}}

[testenv:type]
description = run type checks
changedir = {tox_root}
ignore_outcome = true
deps =
    mypy >= 1.2.0
    types-requests
commands =
    {envpython} -m mypy {posargs:src tests}

[testenv:pycodestyle]
description = run pycodestyle style checker
changedir = {tox_root}
skip_install = true
deps = pycodestyle
commands = {envpython} -m pycodestyle {posargs:src tests}

[testenv:distcheck]
description = check version consistency across files
changedir = {tox_root}
skip_install = true
commands =
    {envpython} scripts/check_version.py
